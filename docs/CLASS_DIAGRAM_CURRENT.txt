Current Class Diagram (Exact from digimart-domain)
==================================================

Mermaid (classDiagram)
----------------------
classDiagram
direction TB

    class BaseEntity {
        +Long id
    }

    class AuditableEntity {
        +LocalDateTime createdAt
        +LocalDateTime updatedAt
    }

    class TenantEntity {
        +Long tenantId
    }

    class ActivitySector {
        +String label
        +String description
        +boolean active
    }

    class Tenant {
        +String name
        +String subdomain
        +String contactEmail
        +String contactPhone
        +String logoUrl
        +TenantStatus status
        +Locale defaultLocale
        +Long sectorId
    }

    class TenantStatus {
        <<enumeration>>
        ACTIVE
        SUSPENDED
        TRIAL
        EXPIRED
    }

    class Store {
        +String name
        +String code
        +String address
        +String city
        +String postalCode
        +String country
        +String phone
        +String email
        +String imageUrl
        +BigDecimal latitude
        +BigDecimal longitude
        +boolean active
    }

    class User {
        +String email
        +String passwordHash
        +String firstName
        +String lastName
        +String phone
        +String imageUrl
        +boolean enabled
        +LocalDateTime lastLogin
    }

    class RefreshToken {
        +Long userId
        +String tokenHash
        +LocalDateTime expiresAt
        +LocalDateTime revokedAt
        +String deviceInfo
    }

    class Role {
        +String code
        +String label
        +boolean systemRole
    }

    class Permission {
        +String code
        +String domain
        +String description
    }

    class UserRoleAssignment {
        +Long userId
        +Long roleId
        +boolean active
    }

    class RolePermission {
        +Long roleId
        +Long permissionId
    }

    class AuditEvent {
        +String entityType
        +Long entityId
        +AuditAction action
        +String beforeJson
        +String afterJson
        +Long actorUserId
        +String ipAddress
        +String userAgent
        +String correlationId
        +LocalDateTime occurredAt
    }

    class AuditAction {
        <<enumeration>>
        CREATE
        UPDATE
        DELETE
        STATUS_CHANGE
    }

    class Locale {
        <<enumeration>>
        FR
        AR
        EN
    }

    class Category {
        +String name
        +String slug
        +String description
        +Long parentCategoryId
        +Integer displayOrder
        +boolean active
        +Long createdBy
        +Long updatedBy
    }

    class Product {
        +String name
        +String slug
        +String sku
        +String description
        +BigDecimal initialPrice
        +BigDecimal finalPrice
        +BigDecimal costPrice
        +BigDecimal shippingPrice
        +BigDecimal shippingCostPrice
        +boolean trackStock
        +Integer stockQuantity
        +Integer lowStockThreshold
        +ProductStatus status
        +ProductAvailability availability
        +String availabilityText
        +boolean continueSelling
        +boolean showLowestPrice
        +Long createdBy
        +Long updatedBy
    }

    class ProductStatus {
        <<enumeration>>
        ACTIVE
        HIDDEN
        OUT_OF_STOCK
    }

    class ProductAvailability {
        <<enumeration>>
        IN_STOCK
        ON_ORDER
        PRE_ORDER
    }

    class ProductCategory {
        +Long productId
        +Long categoryId
        +boolean primary
        +Integer displayOrder
        +Long createdBy
    }

    class ProductImage {
        +Long productId
        +String imageUrl
        +String altText
        +Integer displayOrder
        +boolean primary
    }

    class ProductStoreInventory {
        +Long productId
        +Long storeId
        +Integer quantity
        +Integer lowStockThreshold
        +boolean activeInStore
    }

    class ProductOption {
        +Long productId
        +String name
        +OptionType type
        +boolean required
        +boolean usedForVariants
        +Integer displayOrder
        +Long createdBy
    }

    class OptionType {
        <<enumeration>>
        TEXT
        COLOR
        IMAGE
        NUMBER
        DROPDOWN
        MULTISELECT
    }

    class ProductOptionValue {
        +Long optionId
        +String value
        +String hexColor
        +Integer displayOrder
        +Long createdBy
    }

    class ProductVariant {
        +Long productId
        +String sku
        +BigDecimal priceOverride
        +BigDecimal initialPriceOverride
        +BigDecimal finalPriceOverride
        +BigDecimal costPriceOverride
        +BigDecimal shippingPriceOverride
        +BigDecimal shippingCostPriceOverride
        +boolean trackStock
        +Integer stockQuantity
        +Integer lowStockThreshold
        +VariantStatus status
        +boolean defaultVariant
        +Boolean continueSellingOverride
        +Long productImageId
        +Long createdBy
        +Long updatedBy
    }

    class VariantStatus {
        <<enumeration>>
        ACTIVE
        DISABLED
    }

    class VariantOptionValue {
        +Long variantId
        +Long optionValueId
    }

    class VariantStoreInventory {
        +Long variantId
        +Long storeId
        +Integer quantity
        +Integer lowStockThreshold
        +boolean activeInStore
    }

    class ProductPriceHistory {
        +Long productId
        +BigDecimal initialPrice
        +BigDecimal finalPrice
        +LocalDateTime changedAt
        +Long changedBy
    }

    class PlatformConfig {
        +String configKey
        +String configValue
        +String description
        +Long updatedBy
    }

    class TenantWallet {
        +BigDecimal balance
        +String currency
        +WalletStatus status
        +LocalDateTime lastTransactionAt
    }

    class WalletStatus {
        <<enumeration>>
        ACTIVE
        SUSPENDED
        FROZEN
    }

    class WalletTransaction {
        +Long walletId
        +WalletTxnType type
        +BigDecimal amount
        +BigDecimal balanceBefore
        +BigDecimal balanceAfter
        +String reason
        +String reference
        +Long processedBy
        +LocalDateTime transactionDate
    }

    class WalletTxnType {
        <<enumeration>>
        INITIAL_CREDIT
        MANUAL_CREDIT
        MANUAL_DEBIT
        ADJUSTMENT
        REFUND
    }

    class PremiumFeature {
        +String code
        +String name
        +String description
        +FeatureCategory category
        +boolean active
        +Integer displayOrder
    }

    class FeatureCategory {
        <<enumeration>>
        ANALYTICS
        SALES
        MARKETING
        TECHNICAL
        SUPPORT
    }

    class SubscriptionPlan {
        +String code
        +String name
        +String description
        +BigDecimal price
        +String currency
        +BillingCycle billingCycle
        +BigDecimal discountPercentage
        +boolean standard
        +boolean active
        +LocalDateTime startDate
        +LocalDateTime endDate
        +Long createdBy
    }

    class BillingCycle {
        <<enumeration>>
        MONTHLY
        QUARTERLY
        YEARLY
        ONE_TIME
    }

    class PlanFeature {
        +Long planId
        +Long featureId
    }

    class TenantSubscription {
        +Long planId
        +SubscriptionStatus status
        +LocalDateTime startDate
        +LocalDateTime endDate
        +LocalDateTime nextBillingDate
        +BigDecimal pricePaid
        +String paymentReference
        +Long activatedBy
        +LocalDateTime activatedAt
        +LocalDateTime cancelledAt
        +String cancellationReason
    }

    class SubscriptionStatus {
        <<enumeration>>
        ACTIVE
        PENDING_ACTIVATION
        EXPIRED
        CANCELLED
        SUSPENDED
    }

    class SubscriptionHistory {
        +Long subscriptionId
        +Long oldPlanId
        +Long newPlanId
        +SubscriptionAction action
        +String notes
        +Long performedBy
        +LocalDateTime performedAt
    }

    class SubscriptionAction {
        <<enumeration>>
        CREATED
        ACTIVATED
        UPGRADED
        DOWNGRADED
        RENEWED
        CANCELLED
        SUSPENDED
        EXPIRED
    }

    AuditableEntity --|> BaseEntity
    TenantEntity --|> AuditableEntity

    ActivitySector --|> AuditableEntity
    Tenant --|> AuditableEntity
    Permission --|> BaseEntity
    PlatformConfig --|> AuditableEntity
    PremiumFeature --|> AuditableEntity
    SubscriptionPlan --|> AuditableEntity
    PlanFeature --|> AuditableEntity

    Store --|> TenantEntity
    User --|> TenantEntity
    RefreshToken --|> TenantEntity
    Role --|> TenantEntity
    UserRoleAssignment --|> TenantEntity
    RolePermission --|> TenantEntity
    AuditEvent --|> TenantEntity
    Category --|> TenantEntity
    Product --|> TenantEntity
    ProductCategory --|> TenantEntity
    ProductImage --|> TenantEntity
    ProductStoreInventory --|> TenantEntity
    ProductOption --|> TenantEntity
    ProductOptionValue --|> TenantEntity
    ProductVariant --|> TenantEntity
    VariantOptionValue --|> TenantEntity
    VariantStoreInventory --|> TenantEntity
    ProductPriceHistory --|> TenantEntity
    TenantWallet --|> TenantEntity
    WalletTransaction --|> TenantEntity
    TenantSubscription --|> TenantEntity
    SubscriptionHistory --|> TenantEntity

    TenantEntity ..> Tenant : tenantId FK

    Tenant --> TenantStatus : status
    Tenant --> Locale : defaultLocale
    Tenant --> ActivitySector : sectorId

    RefreshToken --> User : userId
    UserRoleAssignment --> User : userId
    UserRoleAssignment --> Role : roleId
    RolePermission --> Role : roleId
    RolePermission --> Permission : permissionId
    AuditEvent --> AuditAction : action
    AuditEvent --> User : actorUserId

    Category --> Category : parentCategoryId

    Product --> ProductStatus : status
    Product --> ProductAvailability : availability
    ProductCategory --> Product : productId
    ProductCategory --> Category : categoryId
    ProductImage --> Product : productId
    ProductStoreInventory --> Product : productId
    ProductStoreInventory --> Store : storeId

    ProductOption --> Product : productId
    ProductOption --> OptionType : type
    ProductOptionValue --> ProductOption : optionId

    ProductVariant --> Product : productId
    ProductVariant --> VariantStatus : status
    ProductVariant --> ProductImage : productImageId
    VariantOptionValue --> ProductVariant : variantId
    VariantOptionValue --> ProductOptionValue : optionValueId
    VariantStoreInventory --> ProductVariant : variantId
    VariantStoreInventory --> Store : storeId

    ProductPriceHistory --> Product : productId
    ProductPriceHistory --> User : changedBy

    TenantWallet --> WalletStatus : status
    WalletTransaction --> TenantWallet : walletId
    WalletTransaction --> WalletTxnType : type
    WalletTransaction --> User : processedBy

    PremiumFeature --> FeatureCategory : category
    SubscriptionPlan --> BillingCycle : billingCycle
    PlanFeature --> SubscriptionPlan : planId
    PlanFeature --> PremiumFeature : featureId

    TenantSubscription --> SubscriptionPlan : planId
    TenantSubscription --> SubscriptionStatus : status
    TenantSubscription --> User : activatedBy

    SubscriptionHistory --> TenantSubscription : subscriptionId
    SubscriptionHistory --> SubscriptionPlan : oldPlanId
    SubscriptionHistory --> SubscriptionPlan : newPlanId
    SubscriptionHistory --> SubscriptionAction : action
    SubscriptionHistory --> User : performedBy
